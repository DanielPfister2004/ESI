/*
 * timerB0.c
 *
 *  Created on: 12.11.2025
 *      Author: danie
 */
#include "hal_timerB0.h"
#include "hal_usciB1.h"
#include "hal_LCD.h"

extern USCIB1_SPICom LCD;

// is a 2Hz timer
void timerB0_init()
{
    TB0CTL |= TBSSEL__SMCLK;
    TB0CTL |= ID__8;
    TB0CTL |= MC__UP;

    TB0CCR0 = 19531/2; // 2.5MHz/(8*8) * 0,5 (sind die 2Hz)
    TB0EX0 |= TBIDEX__8;  // extension
    TB0CCTL0 = CCIE;  // activating interrupt
    LCD.Status.TxSuc = 1;
}

// is a 1Hz timer - ideal for 1s waits
void timerB1_init()
{
    TB1CTL |= TBSSEL__SMCLK;
    TB1CTL |= ID__8;
    TB1CTL |= MC__UP;

    TB1CCR0 = 19531;
    TB1EX0 |= TBIDEX__8;  // extension
    TB1CCTL0 = CCIE;  // activating interrupt
}


int cnt = 0;
#pragma vector=TIMER0_B0_VECTOR
__interrupt void TimerB0_ISR(void)
{

    if(cnt == 0)
    {
        cnt = 1;
        LCD_BL_ON();
    }
    else if(cnt == 1)
    {
        cnt = 0;
        LCD_BL_OFF();
    }

   // TB0CCTL0 &= ~CCIFG;   // Clear interrupt flag
}

#pragma vector=TIMER0_B1_VECTOR
__interrupt void TimerB1_ISR(void)
{
   one_hz_cnt++;
   TB0CCTL0 &= ~CCIFG;   // Clear interrupt flag
}
